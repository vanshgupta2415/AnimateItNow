<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contributor Points - AnimateItNow</title>
  <link rel="icon" href="favicon.png" type="image/x-icon" />
  <meta name="description" content="A comprehensive collection of CSS animation templates and effects for web developers" />
  <link rel="icon" type="image/png" href="images/logo.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
  <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>
  
  <style>
    /* CSS Variables for Theming */
    :root {
      --primary: #6c63ff;
      --primary-light: #8a84ff;
      --primary-dark: #554fd8;
      --secondary: #ff6584;
      --accent: #36d1dc;
      --text: #2a2a3c;
      --text-light: #6c757d;
      --bg: #ffffff;
      --bg-secondary: #f8f9fa;
      --bg-tertiary: #e9ecef;
      --border: #dee2e6;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
      --radius: 12px;
      --transition: all 0.3s ease;
      --header-height: 80px;
    }

    /* Dark Mode Variables */
    .dark-theme {
      --primary: #8a84ff;
      --primary-light: #a8a4ff;
      --primary-dark: #6c63ff;
      --secondary: #ff8fa3;
      --accent: #4dd0e1;
      --text: #f8f9fa;
      --text-light: #a0a0a0;
      --bg: #121212;
      --bg-secondary: #1e1e1e;
      --bg-tertiary: #2a2a2a;
      --border: #404040;
      --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    /* Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html {
      scroll-behavior: smooth;
    }

    body {
      font-family: 'Inter', 'Segoe UI', sans-serif;
      line-height: 1.6;
      color: var(--text);
      background-color: var(--bg);
      transition: var(--transition);
      overflow-x: hidden;
    }

    .container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    section {
      padding: 100px 0;
    }

    h1, h2, h3, h4, h5 {
      margin-bottom: 1rem;
      line-height: 1.2;
      font-weight: 700;
    }

    h1 {
      font-size: 3.5rem;
    }

    h2 {
      font-size: 2.5rem;
    }

    h3 {
      font-size: 1.8rem;
    }

    p {
      margin-bottom: 1.5rem;
      color: var(--text-light);
    }

    a {
      text-decoration: none;
      color: inherit;
      transition: var(--transition);
    }

    .btn {
      display: inline-block;
      padding: 14px 32px;
      background-color: var(--primary);
      color: white;
      border-radius: var(--radius);
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: var(--transition);
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: var(--transition);
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn:hover {
      background-color: var(--primary-dark);
      transform: translateY(-3px);
      box-shadow: 0 10px 20px rgba(108, 99, 255, 0.3);
    }

    .btn-secondary {
      background-color: var(--secondary);
    }

    .btn-secondary:hover {
      background-color: #e05574;
      box-shadow: 0 10px 20px rgba(255, 101, 132, 0.3);
    }

    .btn-outline {
      background-color: transparent;
      border: 2px solid var(--primary);
      color: var(--primary);
    }

    .btn-outline:hover {
      background-color: var(--primary);
      color: white;
    }

    /* Header/Navigation */
    .navbar {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: var(--header-height);
      background-color: var(--bg);
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
      z-index: 999;
      transition: var(--transition);
    }

    .dark-theme .navbar {
      box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
    }

    .navbar.scrolled {
      height: 70px;
      background-color: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
    }

    .dark-theme .navbar.scrolled {
      background-color: rgba(18, 18, 18, 0.95);
    }

    .nav-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      height: 100%;
    }

    .nav-left {
      display: flex;
      align-items: center;
    }

    .logo {
      height: 40px;
      margin-right: 10px;
    }

    .site-name {
      font-size: 1.5rem;
      font-weight: 700;
      background: linear-gradient(to right, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .nav-links {
      display: flex;
      list-style: none;
    }

    .nav-links li {
      margin-left: 30px;
      display: flex;
      align-items: center;
    }

    .nav-links a {
      color: var(--text);
      font-weight: 500;
      position: relative;
      padding: 5px 0;
    }

    .nav-links a::after {
      content: '';
      position: absolute;
      width: 0;
      height: 2px;
      bottom: 0;
      left: 0;
      background-color: var(--primary);
      transition: var(--transition);
    }

    .nav-links a:hover::after,
    .nav-links a.active::after {
      width: 100%;
    }

    /* Snake cursor toggle */
    .snakeList {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .switch {
      position: relative;
      display: inline-block;
      width: 50px;
      height: 24px;
    }

    .switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }

    .slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: var(--bg-tertiary);
      transition: var(--transition);
      border-radius: 24px;
    }

    .slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 4px;
      bottom: 4px;
      background-color: white;
      transition: var(--transition);
      border-radius: 50%;
    }

    input:checked + .slider {
      background-color: var(--primary);
    }

    input:checked + .slider:before {
      transform: translateX(26px);
    }

    .github-icon {
      display: flex;
      align-items: center;
      justify-content: center;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      transition: var(--transition);
    }

    .github-icon:hover {
      background-color: var(--bg-tertiary);
    }

    #theme-toggle {
      background: none;
      border: none;
      font-size: 1.2rem;
      cursor: pointer;
      color: var(--text);
      width: 40px;
      height: 40px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: var(--transition);
    }

    #theme-toggle:hover {
      background-color: var(--bg-tertiary);
    }

    .hamburger {
      display: none;
      flex-direction: column;
      background: none;
      border: none;
      cursor: pointer;
      width: 30px;
      height: 30px;
      justify-content: center;
      margin-left: 15px;
    }

    .hamburger span {
      width: 25px;
      height: 3px;
      background-color: var(--text);
      margin: 2px 0;
      transition: var(--transition);
      border-radius: 2px;
    }

    /* Leaderboard Styles */
    .leaderboard-main {
      padding-top: var(--header-height);
      min-height: 100vh;
      background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg) 100%);
    }

    .leaderboard-header {
      text-align: center;
      padding: 100px 0 60px;
    }

    .leaderboard-title {
      font-size: 3.5rem;
      margin-bottom: 20px;
      position: relative;
    }

    .leaderboard-title span {
      color: var(--primary);
      position: relative;
    }

    .leaderboard-subtitle {
      font-size: 1.3rem;
      color: var(--text-light);
      max-width: 600px;
      margin: 0 auto;
    }

    /* Stats Section */
    .leaderboard-stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      margin: 40px 0;
      flex-wrap: wrap;
    }

    .stat-card {
      background: var(--bg);
      border-radius: var(--radius);
      padding: 25px;
      text-align: center;
      box-shadow: var(--shadow);
      transition: var(--transition);
      border: 1px solid var(--border);
      min-width: 200px;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
    }

    .stat-value {
      font-size: 2.5rem;
      font-weight: 700;
      color: var(--primary);
      margin-bottom: 10px;
    }

    .stat-label {
      font-size: 1rem;
      color: var(--text-light);
      font-weight: 600;
    }

    /* Search and Filter Section */
    .search-filter-section {
      background: var(--bg);
      border-radius: var(--radius);
      padding: 30px;
      margin: 40px auto;
      box-shadow: var(--shadow);
      border: 1px solid var(--border);
      max-width: 1000px;
    }

    .search-container {
      display: flex;
      margin-bottom: 30px;
      position: relative;
    }

    .search-input {
      flex: 1;
      padding: 15px 20px;
      font-size: 1.1rem;
      border-radius: var(--radius) 0 0 var(--radius);
      border: 2px solid var(--border);
      background: var(--bg);
      color: var(--text);
      outline: none;
      transition: var(--transition);
    }

    .search-input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.1);
    }

    .search-btn {
      padding: 15px 25px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: 0 var(--radius) var(--radius) 0;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
    }

    .search-btn:hover {
      background: var(--primary-dark);
    }

    .filter-container {
      display: flex;
      gap: 20px;
      flex-wrap: wrap;
    }

    .filter-group {
      flex: 1;
      min-width: 200px;
    }

    .filter-label {
      display: block;
      margin-bottom: 10px;
      font-weight: 600;
      color: var(--text);
    }

    .filter-select {
      width: 100%;
      padding: 12px 15px;
      border-radius: var(--radius);
      border: 2px solid var(--border);
      background: var(--bg);
      color: var(--text);
      cursor: pointer;
      transition: var(--transition);
    }

    .filter-select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.1);
      outline: none;
    }

    /* Table Section */
    .table-section {
      max-width: 1200px;
      margin: 0 auto 60px;
    }

    .table-container {
      background: var(--bg);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
      border: 1px solid var(--border);
    }

    .leaderboard-table {
      width: 100%;
      border-collapse: collapse;
    }

    .leaderboard-table th {
      background: linear-gradient(135deg, var(--primary), var(--accent));
      color: white;
      padding: 20px 15px;
      text-align: left;
      font-weight: 600;
      font-size: 1.1rem;
    }

    .leaderboard-table td {
      padding: 15px;
      border-bottom: 1px solid var(--border);
      transition: var(--transition);
    }

    .leaderboard-table tbody tr:hover {
      background: rgba(108, 99, 255, 0.05);
    }

    .leaderboard-table tbody tr:nth-child(1) {
      background: rgba(255, 215, 0, 0.1);
    }

    .leaderboard-table tbody tr:nth-child(2) {
      background: rgba(192, 192, 192, 0.1);
    }

    .leaderboard-table tbody tr:nth-child(3) {
      background: rgba(205, 127, 50, 0.1);
    }

    .rank-cell {
      text-align: center;
      font-weight: 700;
      font-size: 1.2rem;
    }

    .contributor-cell {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .contributor-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      object-fit: cover;
      border: 3px solid var(--border);
    }

    .contributor-name {
      font-weight: 600;
      color: var(--text);
    }

    .prs-cell {
      max-width: 400px;
    }

    .pr-summary {
      cursor: pointer;
      font-weight: 600;
      color: var(--primary);
      margin-bottom: 10px;
      display: block;
    }

    .pr-list {
      margin: 0;
      padding-left: 20px;
    }

    .pr-list li {
      margin-bottom: 8px;
      font-size: 0.9rem;
    }

    .pr-list a {
      color: var(--primary);
      text-decoration: none;
    }

    .pr-list a:hover {
      text-decoration: underline;
    }

    .points-cell {
      text-align: center;
      font-weight: 700;
      font-size: 1.2rem;
      color: var(--primary);
    }

    /* Pagination */
    .pagination-container {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      margin: 40px 0;
    }

    .pagination-btn {
      padding: 12px 20px;
      background: var(--primary);
      color: white;
      border: none;
      border-radius: var(--radius);
      cursor: pointer;
      font-weight: 600;
      transition: var(--transition);
    }

    .pagination-btn:hover:not(:disabled) {
      background: var(--primary-dark);
      transform: translateY(-2px);
    }

    .pagination-btn:disabled {
      background: var(--text-light);
      cursor: not-allowed;
    }

    .pagination-info {
      font-weight: 600;
      color: var(--text);
    }

    /* Download Section */
    .download-section {
      text-align: center;
      margin: 60px 0;
    }

    .download-button {
      background: linear-gradient(135deg, var(--secondary), #ff8fa3);
      color: white;
      padding: 16px 32px;
      border: none;
      margin:25px;
      border-radius: var(--radius);
      font-weight: 700;
      font-size: 1.1rem;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 6px 20px rgba(255, 101, 132, 0.2);
    }

    .download-button:hover {
      transform: translateY(-3px) scale(1.05);
      box-shadow: 0 8px 25px rgba(255, 101, 132, 0.3);
    }

    /* Footer */
    .footer {
      background-color: var(--bg-secondary);
      color: var(--text);
      padding: 60px 0 30px;
      border-top: 1px solid var(--border);
    }

    .footer-content {
      display: flex;
      justify-content: space-between;
      margin-bottom: 40px;
    }

    .footer-left h2 {
      margin-bottom: 15px;
      background: linear-gradient(to right, var(--primary), var(--accent));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .footer-right h4 {
      margin-bottom: 20px;
    }

    .footer-right ul {
      list-style: none;
    }

    .footer-right li {
      margin-bottom: 10px;
    }

    .footer-right a {
      color: var(--text-light);
      transition: var(--transition);
    }

    .footer-right a:hover {
      color: var(--primary);
    }

    .footer-right a i {
      margin-right: 10px;
    }

    .footer-bottom {
      text-align: center;
      padding-top: 30px;
      border-top: 1px solid var(--border);
      color: var(--text-light);
      font-size: 0.9rem;
    }

    .footer-bottom .highlight {
      color: var(--primary);
      font-weight: 600;
    }

    /* Scroll to top button */
    #scrollBtn {
      display: none;
      position: fixed;
      bottom: 30px;
      right: 30px;
      z-index: 99;
      border: none;
      outline: none;
      background-color: var(--primary);
      color: white;
      cursor: pointer;
      padding: 15px;
      border-radius: 50%;
      font-size: 18px;
      width: 50px;
      height: 50px;
      box-shadow: var(--shadow);
      transition: var(--transition);
    }

    #scrollBtn:hover {
      background-color: var(--primary-dark);
      transform: translateY(-3px);
    }

    /* Loading State */
    .loading-state {
      text-align: center;
      padding: 60px 20px;
    }

    .loader {
      border: 6px solid var(--border);
      border-top: 6px solid var(--primary);
      border-radius: 50%;
      width: 60px;
      height: 60px;
      animation: spin 1.2s linear infinite;
      margin: 0 auto 20px;
    }

    .loading-text {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--text-light);
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive Design */
    @media (max-width: 992px) {
      .leaderboard-title {
        font-size: 2.8rem;
      }
      
      .leaderboard-stats {
        gap: 20px;
      }
      
      .stat-card {
        min-width: 160px;
      }
    }

    @media (max-width: 768px) {
      .nav-links {
        position: fixed;
        top: var(--header-height);
        left: -100%;
        width: 100%;
        height: calc(100vh - var(--header-height));
        background-color: var(--bg);
        flex-direction: column;
        justify-content: flex-start;
        align-items: center;
        padding-top: 50px;
        transition: left var(--transition);
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        z-index: 998;
      }

      .nav-links.active {
        left: 0;
      }

      .nav-links li {
        margin: 20px 0;
      }

      .nav-links a {
        font-size: 1.1rem;
        padding: 10px 20px;
      }

      .hamburger {
        display: flex;
      }

      .hamburger.active span:nth-child(1) {
        transform: rotate(45deg) translate(5px, 5px);
      }

      .hamburger.active span:nth-child(2) {
        opacity: 0;
      }

      .hamburger.active span:nth-child(3) {
        transform: rotate(-45deg) translate(7px, -6px);
      }
      
      .leaderboard-title {
        font-size: 2.2rem;
      }
      
      .leaderboard-subtitle {
        font-size: 1.1rem;
      }
      
      .search-filter-section {
        padding: 20px;
      }
      
      .search-container {
        flex-direction: column;
      }
      
      .search-input {
        border-radius: var(--radius) var(--radius) 0 0;
      }
      
      .search-btn {
        border-radius: 0 0 var(--radius) var(--radius);
      }
      
      .filter-container {
        flex-direction: column;
        gap: 15px;
      }
      
      .leaderboard-table {
        font-size: 0.9rem;
      }
      
      .leaderboard-table th,
      .leaderboard-table td {
        padding: 12px 8px;
      }
      
      .contributor-avatar {
        width: 40px;
        height: 40px;
      }
    }

    @media (max-width: 576px) {
      .leaderboard-title {
        font-size: 1.8rem;
      }
      
      .leaderboard-stats {
        flex-direction: column;
        align-items: center;
      }
      
      .stat-card {
        width: 100%;
        max-width: 300px;
      }
      
      .leaderboard-table {
        font-size: 0.8rem;
      }
      
      .contributor-cell {
        flex-direction: column;
        text-align: center;
        gap: 8px;
      }
      
      .contributor-avatar {
        width: 35px;
        height: 35px;
      }
    }
  </style>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Contributor Points - AnimateItNow</title>
    <link rel="icon" href="favicon.png" type="image/x-icon" />
    <meta name="description"
        content="A comprehensive collection of CSS animation templates and effects for web developers" />
    <link rel="icon" type="image/png" href="images/logo.png" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css">
    <script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

    <style>
        /* CSS Variables for Theming */
        :root {
            --primary: #6c63ff;
            --primary-light: #8a84ff;
            --primary-dark: #554fd8;
            --secondary: #ff6584;
            --accent: #36d1dc;
            --text: #2a2a3c;
            --text-light: #6c757d;
            --bg: #ffffff;
            --bg-secondary: #f8f9fa;
            --bg-tertiary: #e9ecef;
            --border: #dee2e6;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --radius: 12px;
            --transition: all 0.3s ease;
            --header-height: 80px;
        }

        /* Dark Mode Variables */
        .dark-theme {
            --primary: #8a84ff;
            --primary-light: #a8a4ff;
            --primary-dark: #6c63ff;
            --secondary: #ff8fa3;
            --accent: #4dd0e1;
            --text: #f8f9fa;
            --text-light: #a0a0a0;
            --bg: #121212;
            --bg-secondary: #1e1e1e;
            --bg-tertiary: #2a2a2a;
            --border: #404040;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Inter', 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: var(--text);
            background-color: var(--bg);
            transition: var(--transition);
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        section {
            padding: 100px 0;
        }

        h1,
        h2,
        h3,
        h4,
        h5 {
            margin-bottom: 1rem;
            line-height: 1.2;
            font-weight: 700;
        }

        h1 {
            font-size: 3.5rem;
        }

        h2 {
            font-size: 2.5rem;
        }

        h3 {
            font-size: 1.8rem;
        }

        p {
            margin-bottom: 1.5rem;
            color: var(--text-light);
        }

        a {
            text-decoration: none;
            color: inherit;
            transition: var(--transition);
        }

        .btn {
            display: inline-block;
            padding: 14px 32px;
            background-color: var(--primary);
            color: white;
            border-radius: var(--radius);
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: var(--transition);
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(108, 99, 255, 0.3);
        }

        .btn-secondary {
            background-color: var(--secondary);
        }

        .btn-secondary:hover {
            background-color: #e05574;
            box-shadow: 0 10px 20px rgba(255, 101, 132, 0.3);
        }

        .btn-outline {
            background-color: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        /* Header/Navigation */
        .navbar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: var(--header-height);
            background-color: var(--bg);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            z-index: 999;
            transition: var(--transition);
        }

        .dark-theme .navbar {
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
        }

        .navbar.scrolled {
            height: 70px;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
        }

        .dark-theme .navbar.scrolled {
            background-color: rgba(18, 18, 18, 0.95);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 100%;
        }

        .nav-left {
            display: flex;
            align-items: center;
        }

        .logo {
            height: 40px;
            margin-right: 10px;
        }

        .site-name {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .nav-links {
            display: flex;
            list-style: none;
        }

        .nav-links li {
            margin-left: 30px;
            display: flex;
            align-items: center;
        }

        .nav-links a {
            color: var(--text);
            font-weight: 500;
            position: relative;
            padding: 5px 0;
        }

        .nav-links a::after {
            content: '';
            position: absolute;
            width: 0;
            height: 2px;
            bottom: 0;
            left: 0;
            background-color: var(--primary);
            transition: var(--transition);
        }

        .nav-links a:hover::after,
        .nav-links a.active::after {
            width: 100%;
        }

        /* Snake cursor toggle */
        .snakeList {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-tertiary);
            transition: var(--transition);
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: var(--transition);
            border-radius: 50%;
        }

        input:checked+.slider {
            background-color: var(--primary);
        }

        input:checked+.slider:before {
            transform: translateX(26px);
        }

        .github-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            transition: var(--transition);
        }

        .github-icon:hover {
            background-color: var(--bg-tertiary);
        }

        #theme-toggle {
            background: none;
            border: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: var(--text);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
        }

        #theme-toggle:hover {
            background-color: var(--bg-tertiary);
        }

        .hamburger {
            display: none;
            flex-direction: column;
            background: none;
            border: none;
            cursor: pointer;
            width: 30px;
            height: 30px;
            justify-content: center;
            margin-left: 15px;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background-color: var(--text);
            margin: 2px 0;
            transition: var(--transition);
            border-radius: 2px;
        }

        /* Leaderboard Styles */
        .leaderboard-main {
            padding-top: var(--header-height);
            min-height: 100vh;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--bg) 100%);
        }

        .leaderboard-header {
            text-align: center;
            padding: 100px 0 60px;
        }

        .leaderboard-title {
            font-size: 3.5rem;
            margin-bottom: 20px;
            position: relative;
        }

        .leaderboard-title span {
            color: var(--primary);
            position: relative;
        }

        .leaderboard-subtitle {
            font-size: 1.3rem;
            color: var(--text-light);
            max-width: 600px;
            margin: 0 auto;
        }

        /* Stats Section */
        .leaderboard-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin: 40px 0;
            flex-wrap: wrap;
        }

        .stat-card {
            background: var(--bg);
            border-radius: var(--radius);
            padding: 25px;
            text-align: center;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border: 1px solid var(--border);
            min-width: 200px;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-light);
            font-weight: 600;
        }

        /* Search and Filter Section */
        .search-filter-section {
            background: var(--bg);
            border-radius: var(--radius);
            padding: 30px;
            margin: 40px auto;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            max-width: 1000px;
        }

        .search-container {
            display: flex;
            margin-bottom: 30px;
            position: relative;
        }

        .search-input {
            flex: 1;
            padding: 15px 20px;
            font-size: 1.1rem;
            border-radius: var(--radius) 0 0 var(--radius);
            border: 2px solid var(--border);
            background: var(--bg);
            color: var(--text);
            outline: none;
            transition: var(--transition);
        }

        .search-input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.1);
        }

        .search-btn {
            padding: 15px 25px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: 0 var(--radius) var(--radius) 0;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .search-btn:hover {
            background: var(--primary-dark);
        }

        .filter-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .filter-group {
            flex: 1;
            min-width: 200px;
        }

        .filter-label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text);
        }

        .filter-select {
            width: 100%;
            padding: 12px 15px;
            border-radius: var(--radius);
            border: 2px solid var(--border);
            background: var(--bg);
            color: var(--text);
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(108, 99, 255, 0.1);
            outline: none;
        }

        /* Table Section */
        .table-section {
            max-width: 1200px;
            margin: 0 auto 60px;
        }

        .table-container {
            background: var(--bg);
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            border: 1px solid var(--border);
        }

        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
        }

        .leaderboard-table th {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 20px 15px;
            text-align: left;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .leaderboard-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border);
            transition: var(--transition);
        }

        .leaderboard-table tbody tr:hover {
            background: rgba(108, 99, 255, 0.05);
        }

        .leaderboard-table tbody tr:nth-child(1) {
            background: rgba(255, 215, 0, 0.1);
        }

        .leaderboard-table tbody tr:nth-child(2) {
            background: rgba(192, 192, 192, 0.1);
        }

        .leaderboard-table tbody tr:nth-child(3) {
            background: rgba(205, 127, 50, 0.1);
        }

        .rank-cell {
            text-align: center;
            font-weight: 700;
            font-size: 1.2rem;
        }

        .contributor-cell {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .contributor-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--border);
        }

        .contributor-name {
            font-weight: 600;
            color: var(--text);
        }

        .prs-cell {
            max-width: 400px;
        }

        .pr-summary {
            cursor: pointer;
            font-weight: 600;
            color: var(--primary);
            margin-bottom: 10px;
            display: block;
        }

        .pr-list {
            margin: 0;
            padding-left: 20px;
        }

        .pr-list li {
            margin-bottom: 8px;
            font-size: 0.9rem;
        }

        .pr-list a {
            color: var(--primary);
            text-decoration: none;
        }

        .pr-list a:hover {
            text-decoration: underline;
        }

        .points-cell {
            text-align: center;
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--primary);
        }

        /* Pagination */
        .pagination-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 40px 0;
        }

        .pagination-btn {
            padding: 12px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
        }

        .pagination-btn:hover:not(:disabled) {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .pagination-btn:disabled {
            background: var(--text-light);
            cursor: not-allowed;
        }

        .pagination-info {
            font-weight: 600;
            color: var(--text);
        }

        /* Download Section */
        .download-section {
            text-align: center;
            margin: 60px 0;
        }

        .download-button {
            background: linear-gradient(135deg, var(--secondary), #ff8fa3);
            color: white;
            padding: 16px 32px;
            border: none;
            border-radius: var(--radius);
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 6px 20px rgba(255, 101, 132, 0.2);
        }

        .download-button:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 8px 25px rgba(255, 101, 132, 0.3);
        }

        /* Footer */
        .footer {
            background-color: var(--bg-secondary);
            color: var(--text);
            padding: 60px 0 30px;
            border-top: 1px solid var(--border);
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            margin-bottom: 40px;
        }

        .footer-left h2 {
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--primary), var(--accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .footer-right h4 {
            margin-bottom: 20px;
        }

        .footer-right ul {
            list-style: none;
        }

        .footer-right li {
            margin-bottom: 10px;
        }

        .footer-right a {
            color: var(--text-light);
            transition: var(--transition);
        }

        .footer-right a:hover {
            color: var(--primary);
        }

        .footer-right a i {
            margin-right: 10px;
        }

        .footer-bottom {
            text-align: center;
            padding-top: 30px;
            border-top: 1px solid var(--border);
            color: var(--text-light);
            font-size: 0.9rem;
        }

        .footer-bottom .highlight {
            color: var(--primary);
            font-weight: 600;
        }

        /* Scroll to top button */
        #scrollBtn {
            display: none;
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 99;
            border: none;
            outline: none;
            background-color: var(--primary);
            color: white;
            cursor: pointer;
            padding: 15px;
            border-radius: 50%;
            font-size: 18px;
            width: 50px;
            height: 50px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }

        #scrollBtn:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
        }

        /* Loading State */
        .loading-state {
            text-align: center;
            padding: 60px 20px;
        }

        .loader {
            border: 6px solid var(--border);
            border-top: 6px solid var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1.2s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-light);
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        /* Responsive Design */
        @media (max-width: 992px) {
            .leaderboard-title {
                font-size: 2.8rem;
            }

            .leaderboard-stats {
                gap: 20px;
            }

            .stat-card {
                min-width: 160px;
            }
        }

        @media (max-width: 768px) {
            .nav-links {
                position: fixed;
                top: var(--header-height);
                left: -100%;
                width: 100%;
                height: calc(100vh - var(--header-height));
                background-color: var(--bg);
                flex-direction: column;
                justify-content: flex-start;
                align-items: center;
                padding-top: 50px;
                transition: left var(--transition);
                box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
                z-index: 998;
            }

            .nav-links.active {
                left: 0;
            }

            .nav-links li {
                margin: 20px 0;
            }

            .nav-links a {
                font-size: 1.1rem;
                padding: 10px 20px;
            }

            .hamburger {
                display: flex;
            }

            .hamburger.active span:nth-child(1) {
                transform: rotate(45deg) translate(5px, 5px);
            }

            .hamburger.active span:nth-child(2) {
                opacity: 0;
            }

            .hamburger.active span:nth-child(3) {
                transform: rotate(-45deg) translate(7px, -6px);
            }

            .leaderboard-title {
                font-size: 2.2rem;
            }

            .leaderboard-subtitle {
                font-size: 1.1rem;
            }

            .search-filter-section {
                padding: 20px;
            }

            .search-container {
                flex-direction: column;
            }

            .search-input {
                border-radius: var(--radius) var(--radius) 0 0;
            }

            .search-btn {
                border-radius: 0 0 var(--radius) var(--radius);
            }

            .filter-container {
                flex-direction: column;
                gap: 15px;
            }

            .leaderboard-table {
                font-size: 0.9rem;
            }

            .leaderboard-table th,
            .leaderboard-table td {
                padding: 12px 8px;
            }

            .contributor-avatar {
                width: 40px;
                height: 40px;
            }
        }

        @media (max-width: 576px) {
            .leaderboard-title {
                font-size: 1.8rem;
            }

            .leaderboard-stats {
                flex-direction: column;
                align-items: center;
            }

            .stat-card {
                width: 100%;
                max-width: 300px;
            }

            .leaderboard-table {
                font-size: 0.8rem;
            }

            .contributor-cell {
                flex-direction: column;
                text-align: center;
                gap: 8px;
            }

            .contributor-avatar {
                width: 35px;
                height: 35px;
            }
        }
    </style>
    <link rel="stylesheet" href="./navbar_styles.css">
</head>

<body>
    <!-- Navigation -->
    <div id="navbar"></div>

  <script>
    fetch('nav.html')
      .then(res => res.text())
      .then(data => {
        document.getElementById('navbar').innerHTML = data;
        // Load the navbar theme manager script
        const script = document.createElement('script');
        script.src = 'navbar-theme.js';
        script.onload = () => {
          console.log('Navbar theme manager loaded successfully');
        };
        document.head.appendChild(script);
      })
      .catch(err => console.error('Error loading navbar:', err));
  </script>

    <!-- Leaderboard Main Content -->
    <main class="leaderboard-main">
        <section class="leaderboard-header">
            <div class="container">
                <h1 class="leaderboard-title">
                    Contributor <span>Leaderboard</span>
                </h1>
                <p class="leaderboard-subtitle">
                    Track contributions and celebrate our amazing community members
                </p>
            </div>
        </section>

        <section class="container">
            <!-- Stats Section -->
            <div class="leaderboard-stats">
                <div class="stat-card">
                    <div class="stat-value" id="totalContributors">0</div>
                    <div class="stat-label">Contributors</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalPRs">0</div>
                    <div class="stat-label">Total Contributions</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalPoints">0</div>
                    <div class="stat-label">Total Points</div>
                </div>
            </div>

            <!-- Search and Filter Section -->
            <div class="search-filter-section">
                <div class="search-container">
                    <input type="text" id="searchUser" class="search-input" placeholder="Search contributors..." />
                    <button id="searchBtn" class="search-btn">
                        Search
                    </button>
                </div>

                <div class="filter-container">
                    <div class="filter-group">
                        <label class="filter-label">Time Period</label>
                        <select id="timeFilter" class="filter-select">
                            <option value="all">All Time</option>
                            <option value="week1">Week 1</option>
                            <option value="week2">Week 2</option>
                            <option value="week3">Week 3</option>
                            <option value="week4">Week 4</option>
                            <option value="month">This Month</option>
                        </select>
                    </div>

                    <div class="filter-group">
                        <label class="filter-label">Sort By</label>
                        <select id="sortFilter" class="filter-select">
                            <option value="points">Points (High to Low)</option>
                            <option value="name">Name (A to Z)</option>
                            <option value="prs">PR Count (High to Low)</option>
                        </select>
                    </div>
                </div>
            </div>

            <!-- Table Section -->
            <div class="table-section">
                <div class="table-container">
                    <table id="pointsTable" class="leaderboard-table">
                        <thead>
                            <tr>
                                <th style="width: 10%;">Rank</th>
                                <th style="width: 25%;">Contributor</th>
                                <th style="width: 45%;">Contributions</th>
                                <th style="width: 20%;">Points</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="4" class="loading-state">
                                    <div class="loader"></div>
                                    <p class="loading-text">Fetching data from GitHub...</p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div id="pagination" class="pagination-container"></div>
            </div>



            <!-- Download Section -->
            <div class="download-section">
                <button class="download-button" onclick="downloadExcel()">
                    <i class="fas fa-download"></i> Download as Excel
                </button>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-left">
                    <h2>AnimateItNow</h2>
                    <p>Creating impactful web animations and templates for everyone.</p>
                </div>
                <div class="footer-right">
                    <h4>Connect With Us</h4>
                    <ul>
                        <li><a href="https://github.com/AnujShrivastava01/AnimateItNow" target="_blank"
                                rel="noopener noreferrer"><i class="fab fa-github"></i> GitHub</a></li>
                        <li><a href="https://www.linkedin.com/in/anujshrivastava1/" target="_blank"
                                rel="noopener noreferrer"><i class="fab fa-linkedin"></i> LinkedIn</a></li>
                        <li><a href="mailto:contact@animateitnow.com" rel="noopener noreferrer"><i
                                    class="fas fa-envelope"></i> Email Us</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>© 2025 AnimateItNow. Made with ❤️ by <span class="highlight">Anuj</span> and Contributors.</p>
            </div>
        </div>
    </footer>

    <!-- Scroll to top button -->
    <button onclick="scrollToTop()" id="scrollBtn" title="Go to top">↑</button>

    <script>
    // Final, Corrected Leaderboard Script with Caching
    const owner = "AnujShrivastava01";
    const repo = "AnimateItNow";
    const pointsPerLevel = {
        "level1": 3, "level2": 7, "level3": 10, "good first issue": 2, "bug": 5,
        "enhancement": 8, "documentation": 4, "hacktoberfest": 3
    };
    let contributorsData = [];
    let currentPage = 1;
    const perPage = 10;
    let currentSort = 'points';
    let filteredData = null;

    // GitHub API headers with hardcoded token
    // IMPORTANT: Make sure this token has 'public_repo' scope and hasn't been revoked
    const GITHUB_TOKEN = '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'.trim();
    
    function getApiHeaders() {
        // Validate token format
        if (!GITHUB_TOKEN || GITHUB_TOKEN.length < 10) {
            console.error('❌ Invalid token format');
            throw new Error('GitHub token is missing or invalid');
        }
        
        return {
            'Accept': 'application/vnd.github.v3+json',
            'User-Agent': 'AnimateItNow-Leaderboard',
            // Classic tokens use 'token' prefix (not 'Bearer')
            'Authorization': `token ${GITHUB_TOKEN}`
        };
    }
    
    // Validate token by making a test request
    async function validateToken() {
        try {
            const headers = getApiHeaders();
            console.log('🔍 Testing token... (first 10 chars:', GITHUB_TOKEN.substring(0, 10) + '...)');
            
            const response = await fetch('https://api.github.com/user', {
                method: 'GET',
                headers: headers,
                mode: 'cors',
                cache: 'no-cache'
            });
            
            const responseText = await response.text();
            let errorData = {};
            try {
                errorData = JSON.parse(responseText);
            } catch (e) {
                errorData = { message: responseText || 'Unknown error' };
            }
            
            if (response.status === 401) {
                console.error('❌ Token validation failed (401):', errorData);
                console.error('Response status:', response.status);
                console.error('Response headers:', {
                    'X-RateLimit-Remaining': response.headers.get('X-RateLimit-Remaining'),
                    'X-RateLimit-Reset': response.headers.get('X-RateLimit-Reset')
                });
                
                let errorMsg = 'Bad credentials';
                if (errorData.message) {
                    errorMsg = errorData.message;
                } else if (errorData.documentation_url) {
                    errorMsg += `. See: ${errorData.documentation_url}`;
                }
                
                return { 
                    valid: false, 
                    error: errorMsg,
                    details: errorData
                };
            }
            
            if (response.ok) {
                const userData = JSON.parse(responseText);
                console.log('✅ Token validated successfully. Authenticated as:', userData.login || 'Unknown');
                return { valid: true, user: userData.login };
            }
            
            return { valid: false, error: `Unexpected status: ${response.status}`, details: errorData };
        } catch (error) {
            console.error('Token validation error:', error);
            return { valid: false, error: error.message };
        }
    }

    // --- UTILITY FUNCTIONS ---
    function scrollToTop() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
    window.onscroll = () => {
        const scrollBtn = document.getElementById("scrollBtn");
        if (scrollBtn) {
            scrollBtn.style.display = (document.body.scrollTop > 300 || document.documentElement.scrollTop > 300) ? "block" : "none";
        }
    };

    // --- DATA FETCHING & PROCESSING ---
    async function fetchAllPages(url) {
        let results = [];
        let page = 1;
        const maxPages = 10; // Safety limit
        
        while (page <= maxPages) {
            try {
                const pageUrl = url.includes('?') ? `${url}&page=${page}` : `${url}?page=${page}`;
                const headers = getApiHeaders();
                
                // Debug: Log request details (remove token from log)
                console.log(`Fetching: ${pageUrl}`);
                console.log('Headers:', { ...headers, Authorization: 'token ***' });
                
                const response = await fetch(pageUrl, { 
                    method: 'GET',
                    headers: headers,
                    mode: 'cors',
                    cache: 'no-cache'
                });
                
                // Check rate limit
                const remaining = response.headers.get('X-RateLimit-Remaining');
                const resetTime = response.headers.get('X-RateLimit-Reset');
                
                if (response.status === 401) {
                    const errorData = await response.json().catch(() => ({}));
                    console.error('401 Error Details:', errorData);
                    console.error('Response Headers:', {
                        'X-RateLimit-Remaining': remaining,
                        'X-RateLimit-Reset': resetTime,
                        'X-GitHub-Media-Type': response.headers.get('X-GitHub-Media-Type')
                    });
                    throw new Error(`GitHub API authentication failed (401). ${errorData.message || 'Bad credentials. Token may be invalid, expired, or missing required scopes.'}`);
                }
                
            if (response.status === 403) {
                    if (resetTime) {
                        const resetDate = new Date(parseInt(resetTime) * 1000);
                        throw new Error(`GitHub API rate limit exceeded. Please try again after ${resetDate.toLocaleTimeString()}`);
            }
                    throw new Error(`GitHub API error! Status: ${response.status}. Rate limit may be exceeded.`);
                }
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`GitHub API error! Status: ${response.status}. ${errorData.message || ''}`);
                }
            
            const data = await response.json();
                
                // Check if we have data
                if (!Array.isArray(data) || data.length === 0) {
                    break; // No more pages
                }
            
            results = results.concat(data);
                
                // If we got less than 100 items, we're likely on the last page
                if (data.length < 100) {
                    break;
                }
                
            page++;
            } catch (error) {
                console.error(`Error fetching page ${page}:`, error);
                throw error;
        }
        }
        
        return results;
    }

    function calculateContributorData(contributions) {
        const data = {};
        contributions.forEach(item => {
            // Handle both PRs (item.user) and issues (item.user)
            // Skip if no user or if it's a PR that wasn't merged (for PRs)
            if (!item.user || !item.user.login) return;
            
            // For PRs, only count merged ones (already filtered, but double-check)
            if (item.pull_request && !item.merged_at) return;
            
            const user = item.user.login;
            const avatar = item.user.avatar_url || 'https://github.com/identicons/' + user + '.png';
            
            if (!data[user]) {
                data[user] = { contributions: [], total: 0, avatar: avatar };
            }
            
            // Get labels (both PRs and issues have labels)
            const labels = (item.labels || []).map(label => 
                typeof label === 'string' ? label.toLowerCase() : label.name.toLowerCase()
            );
            
            let points = 0;
            let contributionType = 'unknown';

            // Check for level labels first
            const levelLabel = labels.find(l => l.startsWith("level") && pointsPerLevel[l]);
            if (levelLabel) {
                points = pointsPerLevel[levelLabel];
                contributionType = levelLabel;
            } else {
                // Check for other matching labels
                const matchedLabel = labels.find(l => pointsPerLevel[l]);
                if (matchedLabel) {
                    points = pointsPerLevel[matchedLabel];
                    contributionType = matchedLabel;
                } else {
                    // Default points: PRs get 5, issues get 2
                    points = item.pull_request ? 5 : 2;
                    contributionType = item.pull_request ? 'pull_request' : 'issue';
                }
            }
            
            if (points > 0) {
                data[user].contributions.push({
                    title: item.title || 'Untitled',
                    url: item.html_url || '#',
                    points,
                    type: contributionType
                });
                data[user].total += points;
            }
        });
        return Object.entries(data);
    }

    // --- RENDERING FUNCTIONS ---
    function updateStats(data) {
        document.getElementById('totalContributors').textContent = data.length;
        const totalContributions = data.reduce((acc, [, userData]) => acc + userData.contributions.length, 0);
        document.getElementById('totalPRs').textContent = totalContributions;
        const totalPoints = data.reduce((acc, [, userData]) => acc + userData.total, 0);
        document.getElementById('totalPoints').textContent = totalPoints;
    }

    function renderTablePage(page) {
        const tbody = document.querySelector("#pointsTable tbody");
        tbody.innerHTML = "";
        let dataToShow = filteredData ? filteredData : contributorsData;
        
        // Always sort a copy of the data
        const sortedData = [...dataToShow].sort((a, b) => {
            if (currentSort === 'points') return b[1].total - a[1].total;
            if (currentSort === 'name') return a[0].localeCompare(b[0]);
            if (currentSort === 'prs') return b[1].contributions.length - a[1].contributions.length;
            return 0;
        });

        const startIdx = (page - 1) * perPage;
        const endIdx = startIdx + perPage;
        const pageData = sortedData.slice(startIdx, endIdx);

        if (pageData.length === 0) {
            tbody.innerHTML = `<tr><td colspan="4" style="text-align: center; padding: 40px;">No contributors found matching your criteria.</td></tr>`;
        } else {
            pageData.forEach(([user, userData], idx) => {
                const row = document.createElement("tr");
                const actualRank = startIdx + idx + 1;
                let rankHtml = actualRank;
                if (currentSort === 'points') {
                    if (actualRank === 1) rankHtml = `🥇 ${actualRank}`;
                    else if (actualRank === 2) rankHtml = `🥈 ${actualRank}`;
                    else if (actualRank === 3) rankHtml = `🥉 ${actualRank}`;
                }
                const contributionListHtml = userData.contributions.map(c => `<li><a href="${c.url}" target="_blank">🔀 ${c.title}</a> - <strong>${c.points} points</strong></li>`).join("");
                row.innerHTML = `
                    <td class="rank-cell">${rankHtml}</td>
                    <td class="contributor-cell"><img class="contributor-avatar" src="${userData.avatar}" alt="${user}'s avatar"><span class="contributor-name">${user}</span></td>
                    <td class="prs-cell"><details><summary class="pr-summary">View Contributions (${userData.contributions.length})</summary><ul class="pr-list">${contributionListHtml}</ul></details></td>
                    <td class="points-cell">${userData.total}</td>
                `;
                tbody.appendChild(row);
            });
        }
        renderPagination(sortedData.length);
    }

    function renderPagination(totalItems) {
        const pagination = document.getElementById("pagination");
        pagination.innerHTML = "";
        const totalPages = Math.ceil(totalItems / perPage);
        if (totalPages <= 1) return;

        const prevBtn = document.createElement("button");
        prevBtn.textContent = "← Previous";
        prevBtn.className = "pagination-btn";
        prevBtn.disabled = currentPage === 1;
        prevBtn.onclick = () => { if (currentPage > 1) { currentPage--; renderTablePage(currentPage); } };

        const nextBtn = document.createElement("button");
        nextBtn.textContent = "Next →";
        nextBtn.className = "pagination-btn";
        nextBtn.disabled = currentPage === totalPages;
        nextBtn.onclick = () => { if (currentPage < totalPages) { currentPage++; renderTablePage(currentPage); } };

        const pageInfo = document.createElement("span");
        pageInfo.className = "pagination-info";
        pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;

        pagination.appendChild(prevBtn);
        pagination.appendChild(pageInfo);
        pagination.appendChild(nextBtn);
    }

    // --- EVENT HANDLERS & INITIALIZATION ---
    function setupEventListeners() {
        const searchInput = document.getElementById('searchUser');
        const sortFilter = document.getElementById('sortFilter');
        const searchBtn = document.getElementById('searchBtn');

        const applyFilters = () => {
            const searchTerm = searchInput.value.trim().toLowerCase();
            if (searchTerm === "") {
                filteredData = null; // Reset filter if search is cleared
            } else {
                filteredData = contributorsData.filter(([user]) => user.toLowerCase().includes(searchTerm));
            }
            currentPage = 1;
            renderTablePage(currentPage);
            updateStats(filteredData || contributorsData);
        };
        
        searchBtn.addEventListener('click', applyFilters);
        searchInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') applyFilters();
        });
        
        sortFilter.addEventListener('change', (e) => {
            currentSort = e.target.value;
            currentPage = 1;
            renderTablePage(currentPage);
        });
    }

    async function init() {
        const cacheKey = 'leaderboardData_AnimateItNow';
        const cacheDuration = 30 * 60 * 1000; // 30 minutes
        const cachedItem = sessionStorage.getItem(cacheKey);

        if (cachedItem) {
            const { timestamp, data } = JSON.parse(cachedItem);
            if (new Date().getTime() - timestamp < cacheDuration) {
                console.log("🚀 Loading data from cache!");
                contributorsData = data;
                updateStats(contributorsData);
                renderTablePage(1);
                setupEventListeners();
                return;
            }
        }

        try {
            // Validate token first
            console.log("🔍 Validating GitHub token...");
            const tokenValidation = await validateToken();
            if (!tokenValidation.valid) {
                const errorDetails = tokenValidation.details ? JSON.stringify(tokenValidation.details, null, 2) : '';
                throw new Error(
                    `Token validation failed: ${tokenValidation.error}\n\n` +
                    `Possible causes:\n` +
                    `1. Token is invalid or expired - Regenerate it at: https://github.com/settings/tokens\n` +
                    `2. Token doesn't have 'public_repo' scope - Check token permissions\n` +
                    `3. Token was revoked - Create a new token\n\n` +
                    `Error details: ${errorDetails}`
                );
            }
            
            console.log("🔄 Fetching fresh data with token...");
            
            // Fetch merged pull requests
            const prUrl = `https://api.github.com/repos/${owner}/${repo}/pulls?state=closed&per_page=100`;
            const allPRs = await fetchAllPages(prUrl);
            const mergedPRs = allPRs.filter(pr => pr.merged_at);
            
            console.log(`📊 Found ${mergedPRs.length} merged PRs`);
            
            // Fetch closed issues for additional contribution tracking
            let allIssues = [];
            try {
                const issuesUrl = `https://api.github.com/repos/${owner}/${repo}/issues?state=closed&per_page=100`;
                allIssues = await fetchAllPages(issuesUrl);
                // Filter out PRs (issues that are actually PRs have pull_request field)
                const actualIssues = allIssues.filter(issue => !issue.pull_request);
                console.log(`📋 Found ${actualIssues.length} closed issues`);
            } catch (issueError) {
                console.warn("⚠️ Could not fetch issues:", issueError);
                // Continue with just PRs
            }
            
            // Combine PRs and issues for calculation
            const allContributions = [...mergedPRs, ...allIssues];
            const data = calculateContributorData(allContributions);
            
            if (data.length === 0) {
                document.querySelector("#pointsTable tbody").innerHTML = `
                    <tr><td colspan="4" style="text-align:center;padding:40px;">
                        <div style="font-size: 1.1rem; margin-bottom: 10px;">📭</div>
                        <div>No contributions found yet! Be the first contributor!</div>
                    </td></tr>
                `;
                updateStats([]);
                setupEventListeners();
                return;
            }

            contributorsData = data;
            sessionStorage.setItem(cacheKey, JSON.stringify({ 
                timestamp: new Date().getTime(), 
                data 
            }));
            console.log(`✅ Data saved to cache! Found ${data.length} contributors`);

            updateStats(contributorsData);
            renderTablePage(1);
            setupEventListeners();

        } catch (error) {
            console.error('❌ Error initializing leaderboard:', error);
            
            // Try to use expired cache if available
            if (cachedItem) {
                const { data } = JSON.parse(cachedItem);
                console.warn("⚠️ Using expired cache due to API error");
                contributorsData = data;
                updateStats(contributorsData);
                renderTablePage(1);
                setupEventListeners();
                return;
            }
            
            const tbody = document.querySelector("#pointsTable tbody");
            if (tbody) {
                tbody.innerHTML = `
                <tr><td colspan="4" style="text-align: center; padding: 40px;">
                    <div style="font-size: 3rem; margin-bottom: 20px;">⚠️</div>
                        <div style="font-size: 1.2rem; font-weight: 600; color: #dc3545; margin-bottom: 10px;">Error Loading Data</div>
                    <div style="font-size: 0.9rem; color: var(--text-light); margin-bottom: 20px;">${error.message}</div>
                        <button onclick="sessionStorage.removeItem('${cacheKey}'); location.reload();" 
                                style="padding: 10px 20px; background: #6C63FF; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 10px;">
                            Force Retry
                        </button>
                </td></tr>
            `;
            }
            
            // Update stats to show zeros
            updateStats([]);
        }
    }

    document.addEventListener('DOMContentLoaded', init);
    
    function downloadExcel() { /* ... your original download function ... */ }
</script>
</body>

</html>